# å® ç‰©ç®¡å®¶ API (Pet Manager API) ğŸ¾

## ğŸ’¡ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº Spring Boot çš„å® ç‰©å¥åº·ç®¡ç†åç«¯æœåŠ¡ï¼Œç”¨äºè·Ÿè¸ªå® ç‰©çš„åŸºæœ¬ä¿¡æ¯ã€å¥åº·äº‹ä»¶ï¼ˆå¦‚ç–«è‹—ã€é©±è™«ï¼‰ä»¥åŠä½“é‡å˜åŒ–è®°å½•ï¼Œå¹¶æ”¯æŒå¥åº·æé†’åŠŸèƒ½ã€‚

## ğŸ“š ç›®å½•

- [ğŸ› ï¸ æŠ€æœ¯æ ˆ](#ï¸-æŠ€æœ¯æ ˆ)
- [ğŸ›ï¸ æ¶æ„ç®€ä»‹](#ï¸-æ¶æ„ç®€ä»‹)
- [âš¡ï¸ æ€§èƒ½ä¼˜åŒ–](#ï¸-æ€§èƒ½ä¼˜åŒ–)
- [ğŸš€ æœ¬åœ°å¯åŠ¨](#-æœ¬åœ°å¯åŠ¨)
- [ğŸ“¦ API æ¥å£æ–‡æ¡£](#-api-æ¥å£æ–‡æ¡£)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

* **åç«¯æ¡†æ¶:** Spring Boot 3.x (ä½¿ç”¨ Java 25)
* **ORM æ¡†æ¶:** MyBatis-Plus 3.x
* **æ•°æ®åº“:** PostgreSQL (æ”¯æŒ Neon å¹³å°)
* **ç¼“å­˜:** Redis
* **æ„å»ºå·¥å…·:** Maven
* **API è§„èŒƒ:** RESTful API

## ğŸ›ï¸ æ¶æ„ç®€ä»‹

é¡¹ç›®é‡‡ç”¨ç»å…¸çš„ä¸‰å±‚æ¶æ„æ¨¡å¼ï¼š

- **Controller å±‚**: è´Ÿè´£æ¥æ”¶ HTTP è¯·æ±‚ï¼ŒéªŒè¯è¾“å…¥ï¼Œå¹¶è°ƒç”¨ Service å±‚å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚
- **Service å±‚**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚ã€‚å¤§éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®æ•´åˆå’Œç¼“å­˜å¤„ç†éƒ½åœ¨è¿™ä¸€å±‚å®Œæˆã€‚
- **Mapper/DAO å±‚**: æ•°æ®è®¿é—®å±‚ï¼Œä½¿ç”¨ MyBatis-Plus ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚

## âš¡ï¸ æ€§èƒ½ä¼˜åŒ–

ä¸ºäº†æå‡é«˜é¢‘è¯»å–æ¥å£çš„æ€§èƒ½ï¼Œé¡¹ç›®é›†æˆäº† Redis ç¼“å­˜ã€‚

- **ç¼“å­˜ç­–ç•¥**: ä½¿ç”¨ Spring Cache æ³¨è§£ (`@Cacheable`, `@CacheEvict`)ï¼Œå°†çƒ­ç‚¹æ•°æ®ç¼“å­˜åˆ° Redis ä¸­ã€‚
- **åºåˆ—åŒ–æ–¹å¼**: ç¼“å­˜é‡‡ç”¨ **JSON æ ¼å¼**è¿›è¡Œåºåˆ—åŒ– (`GenericJackson2JsonRedisSerializer`)ï¼Œè¿™æä¾›äº†è‰¯å¥½çš„çµæ´»æ€§å’Œå¯è¯»æ€§ï¼Œé¿å…äº† Java é»˜è®¤åºåˆ—åŒ–å¸¦æ¥çš„ç‰ˆæœ¬å’Œç±»å‹é—®é¢˜ã€‚
- **ç¼“å­˜å¤±æ•ˆ**: å½“å¯¹æ•°æ®è¿›è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œæ—¶ï¼Œç›¸å…³çš„ç¼“å­˜ä¼šè‡ªåŠ¨å¤±æ•ˆï¼ˆEvictï¼‰ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚
- **ç¼“å­˜èŒƒå›´**: ç›®å‰å·²å¯¹å® ç‰©ä¿¡æ¯ã€å­—å…¸ã€å¥åº·äº‹ä»¶ã€ä½“é‡è®°å½•ã€ç›¸å†Œç­‰æ¨¡å—çš„æŸ¥è¯¢æ¥å£å®ç°äº†ç¼“å­˜ã€‚

## ğŸš€ æœ¬åœ°å¯åŠ¨

### 1. å…‹éš†é¡¹ç›®

```bash
git clone [ä½ çš„ä»£ç ä»“åº“ URL]
cd pets
```

### 2. é…ç½®ç¯å¢ƒ

- **æ•°æ®åº“**: ç¡®ä¿ PostgreSQL æ•°æ®åº“å¯ç”¨ã€‚
- **Redis**: ç¡®ä¿ Redis æœåŠ¡å¯ç”¨ã€‚
- åœ¨ `src/main/resources/application.properties` æ–‡ä»¶ä¸­é…ç½®æ­£ç¡®çš„æ•°æ®åº“å’Œ Redis è¿æ¥ä¿¡æ¯ã€‚

### 3. æ„å»ºé¡¹ç›®

```bash
mvn clean install
```

### 4. è¿è¡Œåº”ç”¨

åœ¨ä½ çš„ IDE (IntelliJ IDEA / Eclipse) ä¸­ï¼Œæ‰¾åˆ° `PetsApplication.java`ï¼Œå³é”®ç‚¹å‡»å¹¶"è¿è¡Œ"ã€‚

æˆ–è€…ä½¿ç”¨ Maven å‘½ä»¤è¡Œï¼š

```bash
mvn spring-boot:run
```

åº”ç”¨å¯åŠ¨åï¼Œé»˜è®¤ä¼šåœ¨ `http://localhost:8080` ä¸Šè¿è¡Œã€‚

## ğŸ“¦ API æ¥å£æ–‡æ¡£

<details>
<summary><strong>0. å¥åº·æ£€æŸ¥æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|------------------|
| GET | `/ping` | å¥åº·æ£€æŸ¥ / ä¿æ´»æ¥å£ | `"pong"` |

</details>

<details>
<summary><strong>1. åª’ä½“æ¥å£ (Media API)</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/media/upload-signature` | è·å– Cloudinary å®‰å…¨ä¸Šä¼ ç­¾å | `{"param1": "value1", "param2": "value2"}` | `{"signature": "...", "timestamp": "...", "api_key": "...", "cloud_name": "..."}` |

</details>

<details>
<summary><strong>2. ç‚¹èµåŠŸèƒ½æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|----------|------------------|
| POST | `/api/pets/{petId}/like` | ç‚¹èµä¸€ä¸ªå® ç‰© | N/A | `{"success": true, "message": "ç‚¹èµæˆåŠŸ"}` |
| GET | `/api/pets/{petId}/likes/count` | è·å–å® ç‰©çš„æ€»ç‚¹èµæ•° | N/A | `{"petId": 1, "count": 10}` |
| GET | `/api/pets/leaderboard` | è·å–å® ç‰©ç‚¹èµæ’è¡Œæ¦œ (æ­¤æ¥å£åœ¨ `PetsController` ä¸­å®ç°) | `topN=10` | `[{"rank": 1, "petId": 12, "name": "è±†è±†", "likeCount": 158}, ...]` |

</details>

<details>
<summary><strong>3. å® ç‰©ç®¡ç†æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/pets` | åˆ›å»ºæ–°å® ç‰© (æ”¯æŒä¸Šä¼ å¤´åƒ) | `{"speciesId": 1, "name": "å’ªå’ª", "profileImageUrl": "...", "profileImagePublicId": "..."}` | `"å® ç‰©æ·»åŠ æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/pets` | è·å–æ‰€æœ‰å® ç‰©åˆ—è¡¨ | N/A | `[{"id": 1, "name": "å’ªå’ª", ...}]` |
| GET | `/api/pets/page` | åˆ†é¡µè·å–å® ç‰©åˆ—è¡¨ | `pageNum=1&pageSize=10` | `{"records": [...], "total": 100, ...}` |
| GET | `/api/pets/{id}` | æ ¹æ®IDè·å–å® ç‰©åŸºæœ¬ä¿¡æ¯ | N/A | `{"id": 1, "name": "å’ªå’ª", ...}` |
| GET | `/api/pets/detail/{id}` | æ ¹æ®IDè·å–å® ç‰©è¯¦ç»†ä¿¡æ¯ | N/A | `{"id": 1, "name": "å’ªå’ª", "weightLogs": [...], ...}` |
| PUT | `/api/pets/{id}` | æ ¹æ®IDæ›´æ–°å® ç‰©ä¿¡æ¯ | `{"name": "å’ªå’ª", "avatarUrl": "..."}` | `{"id": 1, "name": "å’ªå’ª", ...}` |
| DELETE | `/api/pets/{id}` | æ ¹æ®IDåˆ é™¤å® ç‰© | N/A | 204 No Content |
| GET | `/api/pets/species/{species}` | æ ¹æ®ç‰©ç§æŸ¥è¯¢å® ç‰© | N/A | `[{"id": 1, "name": "å’ªå’ª", ...}]` |

</details>

<details>
<summary><strong>4. å¥åº·äº‹ä»¶æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/health-events` | åˆ›å»ºå¥åº·äº‹ä»¶ | `{"petId": 1, "eventTypeId": 1, "eventDate": "2023-10-01"}` | `"å¥åº·äº‹ä»¶æ·»åŠ æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/health-events` | è·å–æ‰€æœ‰å¥åº·äº‹ä»¶ | N/A | `[{"id": 1, "petId": 1, ...}]` |
| GET | `/api/health-events/page` | åˆ†é¡µè·å–å¥åº·äº‹ä»¶ | `pageNum=1&pageSize=10` | `{"records": [...], "total": 50, ...}` |
| GET | `/api/health-events/{id}` | æ ¹æ®IDè·å–å¥åº·äº‹ä»¶ | N/A | `{"id": 1, "petId": 1, ...}` |
| PUT | `/api/health-events/{id}` | æ ¹æ®IDæ›´æ–°å¥åº·äº‹ä»¶ | `{"notes": "æ›´æ–°çš„ç–«è‹—ä¿¡æ¯"}` | `{"id": 1, "notes": "...", ...}` |
| DELETE | `/api/health-events/{id}` | æ ¹æ®IDåˆ é™¤å¥åº·äº‹ä»¶ | N/A | 204 No Content |
| GET | `/api/health-events/pet/{petId}` | æ ¹æ®å® ç‰©IDè·å–å¥åº·äº‹ä»¶ | N/A | `[{"id": 1, "petId": 1, ...}]` |
| GET | `/api/health-events/upcoming` | è·å–å³å°†åˆ°æœŸçš„å¥åº·äº‹ä»¶ï¼ˆ7å¤©å†…ï¼‰ | N/A | `[{"id": 1, "nextDueDate": "...", ...}]` |

</details>

<details>
<summary><strong>5. ä½“é‡è®°å½•æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/weight-logs` | æ·»åŠ ä½“é‡è®°å½• | `{"petId": 1, "weightKg": 5.20, "logDate": "2023-11-13"}` | `"ä½“é‡è®°å½•æ·»åŠ æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/weight-logs` | è·å–æ‰€æœ‰ä½“é‡è®°å½• | N/A | `[{"id": 1, "petId": 1, ...}]` |
| GET | `/api/weight-logs/page` | åˆ†é¡µè·å–ä½“é‡è®°å½• | `pageNum=1&pageSize=10` | `{"records": [...], "total": 30, ...}` |
| GET | `/api/weight-logs/{id}` | æ ¹æ®IDè·å–ä½“é‡è®°å½• | N/A | `{"id": 1, "petId": 1, ...}` |
| PUT | `/api/weight-logs/{id}` | æ ¹æ®IDæ›´æ–°ä½“é‡è®°å½• | `{"weightKg": 5.30}` | `{"id": 1, "weightKg": 5.30, ...}` |
| DELETE | `/api/weight-logs/{id}` | æ ¹æ®IDåˆ é™¤ä½“é‡è®°å½• | N/A | 204 No Content |
| GET | `/api/weight-logs/pet/{petId}` | æ ¹æ®å® ç‰©IDè·å–ä½“é‡è®°å½•å†å² | N/A | `[{"id": 1, "petId": 1, ...}]` |
| GET | `/api/weight-logs/pet/{petId}/latest` | è·å–å® ç‰©æœ€æ–°ä½“é‡è®°å½• | N/A | `{"id": 1, "logDate": "...", ...}` |

</details>

<details>
<summary><strong>6. å­—å…¸é¡¹æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/dictItems` | æ·»åŠ å­—å…¸é¡¹ | `{"dictCode": "pet_species", "itemLabel": "çŒ«"}` | `"å­—å…¸é¡¹æ·»åŠ æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/dictItems` | è·å–æ‰€æœ‰å­—å…¸é¡¹ | N/A | `[{"id": 1, "itemLabel": "çŒ«", ...}]` |
| GET | `/api/dictItems/page` | åˆ†é¡µè·å–å­—å…¸é¡¹ | `pageNum=1&pageSize=10` | `{"records": [...], "total": 20, ...}` |
| GET | `/api/dictItems/{id}` | æ ¹æ®IDè·å–å­—å…¸é¡¹ | N/A | `{"id": 1, "itemLabel": "çŒ«", ...}` |
| PUT | `/api/dictItems/{id}` | æ ¹æ®IDæ›´æ–°å­—å…¸é¡¹ | `{"itemLabel": "çŒ«å’ª"}` | `"å­—å…¸é¡¹æ›´æ–°æˆåŠŸï¼ŒIDï¼š1"` |
| DELETE | `/api/dictItems/{id}` | æ ¹æ®IDåˆ é™¤å­—å…¸é¡¹ | N/A | `"å­—å…¸é¡¹åˆ é™¤æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/dictItems/code/{dictCode}` | æ ¹æ®å­—å…¸ç¼–ç è·å–å­—å…¸é¡¹åˆ—è¡¨ | N/A | `[{"id": 1, "itemLabel": "çŒ«", ...}]` |
| GET | `/api/dictItems/lookup` | æŸ¥æ‰¾æ¥å£(ç”¨äºä¸‹æ‹‰é€‰æ‹©å™¨) | `dictCode=PET_SPECIES` | `[{"id": 1, "label": "çŒ«", ...}]` |

</details>

<details>
<summary><strong>7. å­—å…¸ç±»å‹æ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/dictTypes` | æ·»åŠ å­—å…¸ç±»å‹ | `{"dictCode": "PET_SPECIES", "dictName": "å® ç‰©ç‰©ç§"}` | `"å­—å…¸ç±»å‹æ·»åŠ æˆåŠŸï¼Œç¼–ç ï¼šPET_SPECIES"` |
| GET | `/api/dictTypes` | è·å–æ‰€æœ‰å­—å…¸ç±»å‹åˆ—è¡¨ | N/A | `[{"dictCode": "PET_SPECIES", ...}]` |
| GET | `/api/dictTypes/page` | åˆ†é¡µè·å–å­—å…¸ç±»å‹ | `pageNum=1&pageSize=10` | `{"records": [...], "total": 15, ...}` |
| GET | `/api/dictTypes/{dictCode}` | æ ¹æ®å­—å…¸ç¼–ç è·å–å­—å…¸ç±»å‹ | N/A | `{"dictCode": "PET_SPECIES", ...}` |
| GET | `/api/dictTypes/parent/{parentCode}` | æ ¹æ®çˆ¶çº§ç¼–ç è·å–å­—å…¸ç±»å‹åˆ—è¡¨ | N/A | `[{"dictCode": "PET_SPECIES", ...}]` |
| PUT | `/api/dictTypes/{dictCode}` | æ›´æ–°å­—å…¸ç±»å‹ | `{"dictName": "å® ç‰©ç‰©ç§åˆ†ç±»"}` | `"å­—å…¸ç±»å‹æ›´æ–°æˆåŠŸï¼Œç¼–ç ï¼šPET_SPECIES"` |
| DELETE | `/api/dictTypes/{dictCode}` | åˆ é™¤å­—å…¸ç±»å‹ | N/A | `"å­—å…¸ç±»å‹åˆ é™¤æˆåŠŸï¼Œç¼–ç ï¼šPET_SPECIES"` |

</details>

<details>
<summary><strong>8. å® ç‰©ç›¸å†Œæ¥å£</strong></summary>

| æ–¹æ³• | è·¯å¾„ | æè¿° | è¯·æ±‚ä½“ / æŸ¥è¯¢å‚æ•° | æˆåŠŸå“åº” (200 OK) |
|------|------|------|-----------------|------------------|
| POST | `/api/petGallery` | æ·»åŠ å® ç‰©ç›¸å†Œå›¾ç‰‡ | `{"petId": 1, "imageUrl": "...", "publicId": "...", "description": "..."}` | `"ç›¸å†Œå›¾ç‰‡æ·»åŠ æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/petGallery` | è·å–æ‰€æœ‰å® ç‰©ç›¸å†Œå›¾ç‰‡ | N/A | `[{"id": 1, "petId": 1, ...}]` |
| GET | `/api/petGallery/{id}` | æ ¹æ®IDè·å–å® ç‰©ç›¸å†Œå›¾ç‰‡ | N/A | `{"id": 1, "petId": 1, ...}` |
| PUT | `/api/petGallery/{id}` | æ ¹æ®IDæ›´æ–°å® ç‰©ç›¸å†Œå›¾ç‰‡ | `{"description": "æ›´æ–°åçš„æè¿°"}` | `"ç›¸å†Œå›¾ç‰‡æ›´æ–°æˆåŠŸï¼ŒIDï¼š1"` |
| DELETE | `/api/petGallery/{id}` | æ ¹æ®IDåˆ é™¤å® ç‰©ç›¸å†Œå›¾ç‰‡ | N/A | `"ç›¸å†Œå›¾ç‰‡åˆ é™¤æˆåŠŸï¼ŒIDï¼š1"` |
| GET | `/api/petGallery/pet/{petId}` | æ ¹æ®å® ç‰©IDè·å–ç›¸å†Œåˆ—è¡¨ | N/A | `[{"id": 1, "petId": 1, ...}]` |

</details>

## ğŸ”® æœªæ¥åŠŸèƒ½è§„åˆ’

- [ ] ç”¨æˆ·è®¤è¯å’Œæˆæƒç³»ç»Ÿ
- [ ] å¥åº·æé†’åŠŸèƒ½ï¼ˆé‚®ä»¶/çŸ­ä¿¡é€šçŸ¥ï¼‰
- [ ] ä½“é‡å˜åŒ–è¶‹åŠ¿åˆ†æ
- [ ] å‰ç«¯é¡µé¢å¼€å‘
- [ ] å¤šç”¨æˆ·æ”¯æŒ

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issues å’Œ Pull Requests æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“ è®¸å¯è¯

[MIT License](LICENSE)